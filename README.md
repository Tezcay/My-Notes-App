# 📘 个人笔记管理系统 (Web Note App)

> 《Web 程序设计实践》课程期末项目
> 2023 级 软件工程专业

---

## 📖 1. 项目简介

这是一个基于 **原生 Web 技术（HTML5 + CSS3 + JavaScript）** 开发的现代化个人笔记管理系统。

项目界面深度复刻了 **「小米笔记」** 的清爽风格，并在此基础上实现了 **响应式布局、夜间模式、拖拽归档、Markdown 编辑** 以及 **数据导入导出** 等高级交互功能，旨在提供极致的 Web 笔记体验。

**核心技术亮点：**

- ✅ **零依赖**：无 Vue/React，无 Bootstrap，纯原生 JavaScript 手写核心逻辑。
- ✅ **模块化架构**：代码经过企业级重构，采用清晰的分层模块设计 (Data / UI / Event / Editor)。
- ✅ **数据持久化**：基于 `LocalStorage` 实现数据实时保存与状态记忆，并支持 JSON 文件备份。

---

## ✨ 2. 功能特性 (Features)

### 🎨 2.1 界面与体验

- **三栏式布局**：经典的「文件夹导航 - 笔记列表 - 编辑区域」设计。
- **🌗 夜间模式 (Dark Mode)**：
  - 支持一键切换深色/浅色主题。
  - 自动记忆用户偏好，刷新页面不失效。
- **📱 移动端适配 (Responsive)**：
  - 屏幕宽度小于 768px 时自动切换为移动视图。
  - 侧边栏改为抽屉式交互，编辑器采用滑入式覆盖体验。
- **🔍 智能搜索高亮**：
  - 全文检索笔记标题与内容，匹配关键词自动**高亮显示**（绿色加粗），快速定位。

### 🛠 2.2 核心交互

- **📝 笔记管理**：
  - 支持新建、编辑（实时保存）、删除笔记。
  - **Markdown 支持**：集成 EasyMDE，支持加粗、列表、代码块及**图片粘贴上传**。
  - **回收站机制**：普通删除移入“最近删除”，在回收站中再次删除则永久销毁。
- **📂 文件夹系统**：
  - 支持新建自定义文件夹，右键可删除或重命名文件夹（级联逻辑：文件夹删除后，其下笔记自动归入“未分类”）。
- **🖱️ 拖拽归档 (Drag & Drop)**：
  - 支持直接将笔记从列表中**拖拽**到左侧文件夹进行快速分类。
- **🔃 多维排序**：
  - 支持按“编辑时间倒序”、“编辑时间正序”、“标题 A-Z”三种模式切换。
- **🔐 私密笔记**：
  - 独立的私密笔记入口，支持首次设置密码及后续访问验证，保护敏感内容。
- **💾 数据备份与恢复**：
  - **导出**：将所有笔记和文件夹结构导出为 JSON 文件。
  - **导入**：支持从 JSON 文件恢复数据（覆盖模式），方便数据迁移。

---

## 📖 3. 使用指南 (User Guide)

### 3.1 基础操作

1.  **新建笔记**：点击列表栏右下角的黄色 `+` 悬浮按钮。
2.  **切换视图**：
    - **PC 端**：点击左侧导航栏切换分类。
    - **手机端**：点击左上角 `≡` 菜单键呼出侧边栏。
3.  **切换主题**：点击编辑器右上角的 🌙/☀️ 图标切换日夜模式。
4.  **排序切换**：点击列表上方的“按编辑时间”文字，循环切换排序方式。

### 3.2 进阶操作

- **拖拽整理**：按住笔记列表中的任意项，将其拖动到左侧的文件夹上，松手即可完成分类移动。
- **右键菜单**：在左侧文件夹上点击右键，可选择“重命名”或“删除”。
- **Markdown 预览**：点击工具栏的“眼睛”图标，可实时预览 Markdown 渲染效果。
- **数据备份**：点击编辑器工具栏上方的 **上传/下载图标** 进行数据的导入导出。

---

## 🛠️ 4. 开发文档 (Developer Documentation)

### 4.1 目录结构

```text
MyNotesApp/
├── index.html          # 页面骨架 (语义化 HTML5)
├── styles/
│   └── style.css       # 样式表 (CSS Variables, Flexbox, 分组注释)
├── scripts/
│   ├── 1_data.js       # 模块A：数据层 (Data)
│   ├── 2_utils.js      # 模块B：工具函数 (Utils)
│   ├── 3_ui.js         # 模块C：UI渲染 (View)
│   ├── 4_editor.js     # 模块D：编辑器逻辑 (Editor)
│   ├── 5_advanced.js   # 模块E：高级功能 (Advanced - 包含导入导出)
│   └── 6_main.js       # 模块F：入口与事件 (Controller)
└── README.md           # 项目文档
```

### 4.2 数据结构 (LocalStorage)

**1. 笔记数据 (`notes`)**

```javascript
[
  {
    id: "1735205810234", // 唯一ID (字符串格式的时间戳)
    title: "学习计划",
    content: "## 复习 JavaScript...",
    updateTime: 1735205899999, // 最后编辑时间 (数字时间戳)
    categoryId: "folder-1", // 所属分类ID
  },
];
```

**2. 分类数据 (`categories`)**

```javascript
[
  {
    id: "folder-1735205822222",
    name: "前端开发",
  },
];
```

---

## 🏗️ 5. 代码结构详解 (Code Structure)

经过重构，项目代码采用了严格的模块化组织方式。

### 5.1 JavaScript 模块架构 (`script.js`)

代码按功能逻辑划分为 **6 大模块**，通过详尽的注释分区：

- **📦 模块 A：数据层 (Data Layer)**
  - 负责数据的定义、初始化、LocalStorage 的读写操作以及数据迁移兼容。
- **🔧 模块 B：工具函数 (Utilities)**
  - 提供通用的辅助函数，如 `formatTime` (时间格式化)、`highlightText` (搜索高亮)。
- **🎨 模块 C：UI 渲染 (Rendering)**
  - 负责将数据渲染为 DOM 元素，包括 `renderFolderList` (侧边栏)、`renderNoteList` (笔记列表) 和 `showModal` (弹窗)。
- **⚡ 模块 D：事件处理 (Event Handlers)**
  - 处理用户交互，如点击切换分类 (`switchCategory`)、新建/删除笔记、拖拽逻辑 (`handleMoveNoteToCategory`)。
- **✏️ 模块 E：编辑器集成 (Editor)**
  - 集成 `EasyMDE`，配置自定义工具栏，处理 Markdown 预览、图片粘贴上传及防抖自动保存。
- **🚀 模块 F：高级功能 (Advanced)**
  - 包含私密笔记密码逻辑、右键菜单、**数据导入导出**、主题切换及移动端适配。

### 5.2 CSS 样式组织 (`style.css`)

样式表按作用域划分为 **5 大部分**：

1.  **基础样式 (Foundation)**: 定义 CSS 变量（`:root`, dark theme）、全局重置。
2.  **布局结构 (Layout)**: 三栏布局框架 (`.app`, `.sidebar`, `.list-view`, `.editor-view`)。
3.  **组件样式 (Components)**: 按钮、输入框、列表项、弹窗 (`.modal-box`)、右键菜单。
4.  **编辑器定制 (Editor Customization)**: 深度定制 EasyMDE/CodeMirror 样式，美化 Markdown 预览区。
5.  **响应式与动画 (Responsive)**: 媒体查询 (`max-width: 768px`) 及过渡动画。

---

## 📝 6. 开发进度

- ✅ **阶段一**：静态页面搭建与基础布局
- ✅ **阶段二**：JS 数据渲染与基础 CRUD
- ✅ **阶段三**：分类系统与级联删除
- ✅ **阶段四**：数据持久化 (LocalStorage)
- ✅ **阶段五 (核心功能交付)**：

  - [x] 夜间模式 (Dark Mode)
  - [x] 移动端响应式适配
  - [x] 搜索关键词高亮
  - [x] 笔记拖拽归档
  - [x] 多维度排序
  - [x] Markdown 编辑与预览
  - [x] 私密笔记与密码锁
  - [x] 文件夹右键菜单
  - [x] **数据备份与恢复 (Import/Export)**

- 📅 **未来规划 (Future Roadmap)**：
  - [ ] **笔记标签管理**：支持添加 #Tag 并按标签筛选。
  - [ ] **数据统计图表**：使用 ECharts 展示笔记数量统计。
  - [ ] **笔记提醒功能**：基于浏览器通知 API 的定时提醒。

---

## 📚 7. API 文档 (Core Functions)

以下列出 `script.js` 中的核心函数，供二次开发参考：

| 函数名                           | 模块 | 描述                                                | 参数                               |
| -------------------------------- | ---- | --------------------------------------------------- | ---------------------------------- |
| `saveAllToLocalStorage()`        | A2   | 将当前 `notes` 和 `categories` 保存到浏览器缓存     | 无                                 |
| `renderNoteList()`               | C2   | 根据当前分类、搜索词、排序模式渲染中间列表          | 无                                 |
| `switchCategory(id, name)`       | D1   | 切换当前选中的分类，刷新 UI 并清空编辑器            | `id`: 分类 ID, `name`: 分类名      |
| `loadNoteToEditor(note)`         | C3   | 将笔记内容加载到 EasyMDE 编辑器，并加锁防止触发保存 | `note`: 笔记对象                   |
| `highlightText(text, keyword)`   | B4   | 返回包含高亮 HTML 标签的字符串                      | `text`: 原文, `keyword`: 关键词    |
| `showModal(title, placeh.., cb)` | C4   | 显示通用输入弹窗                                    | `title`, `placeholder`, `callback` |
| `handlePrivateAccess(id, name)`  | F1   | 处理私密笔记的点击逻辑（验证密码/设置密码）         | `id`, `name`                       |

---

## 📖 8. 开发指南 (Development Guide)

### 8.1 如何添加新功能？

1.  **数据层**：如果在 `notes` 对象中增加新字段（如标签），请在 **模块 A1** 更新默认数据结构。
2.  **UI 层**：在 `index.html` 添加对应 DOM，并在 **模块 C** 编写渲染逻辑。
3.  **交互层**：在 **模块 D** 添加事件监听器。

### 8.2 如何自定义主题？

打开 `style.css` 的 **1. 基础样式** 部分，修改 `:root` 下的变量即可：

- `--accent-color`: 修改主色调（默认蓝色）。
- `--accent-yellow`: 修改强调色（默认黄色，用于按钮）。

### 8.3 常见问题 FAQ

- **Q: 为什么图片粘贴后无法显示？**

  - A: 图片会转换为 Base64 字符串存储。如果图片过大（>500KB），代码中有限制会拦截，建议粘贴小图。

- **Q: 数据存在哪里？**
  - A: 存在浏览器的 LocalStorage 中。清除浏览器缓存会丢失数据，建议导出 JSON 进行备份。

---

## 📜 9. 许可证

MIT License
